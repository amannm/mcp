{
  "$schema": "https://raw.githubusercontent.com/schemastore/schemastore/master/src/schemas/json/sarif-2.1.0-rtm.5.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "IntelliJ IDEA",
          "version": "251.27812.49",
          "informationUri": "https://www.jetbrains.com?utm_source=product&utm_medium=link&utm_campaign=IU&utm_content=2025.1",
          "rules": [
            {
              "id": "DuplicatedCode",
              "name": "Duplicated code fragment"
            },
            {
              "id": "EmptyMethod",
              "name": "Empty method"
            },
            {
              "id": "UastIncorrectHttpHeaderInspection",
              "name": "Unknown HTTP header"
            },
            {
              "id": "BooleanMethodIsAlwaysInverted",
              "name": "Boolean method is always inverted"
            },
            {
              "id": "UnnecessaryLocalVariable",
              "name": "Redundant local variable"
            },
            {
              "id": "SameReturnValue",
              "name": "Method always returns the same value"
            },
            {
              "id": "SameParameterValue",
              "name": "Method parameter always has the same value"
            },
            {
              "id": "RedundantThrows",
              "name": "Redundant 'throws' clause"
            },
            {
              "id": "unused",
              "name": "Unused declaration"
            },
            {
              "id": "EqualsWithItself",
              "name": "'equals()' called on itself"
            },
            {
              "id": "MismatchedQueryAndUpdateOfCollection",
              "name": "Mismatched query and update of collection"
            },
            {
              "id": "DataFlowIssue",
              "name": "Nullability and data flow problems"
            },
            {
              "id": "ResultOfMethodCallIgnored",
              "name": "Result of method call ignored"
            },
            {
              "id": "resource",
              "name": "AutoCloseable used without 'try'-with-resources"
            },
            {
              "id": "DuplicateBranchesInSwitch",
              "name": "Duplicate branches in 'switch'"
            }
          ],
          "language": "en-US",
          "contents": [
            "localizedData",
            "nonLocalizedData"
          ],
          "isComprehensive": false
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "workingDirectory": {
            "uri": "file:///Users/amannmalik/IdeaProjects/mcp/"
          }
        }
      ],
      "language": "en-US",
      "results": [
        {
          "ruleId": "DuplicatedCode",
          "kind": "fail",
          "level": "note",
          "message": {
            "text": "Duplicate code: lines 304-322"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/transport/StreamableHttpTransport.java"
                },
                "region": {
                  "startLine": 304,
                  "startColumn": 20,
                  "endLine": 305,
                  "endColumn": 7,
                  "charOffset": 12166,
                  "charLength": 33,
                  "snippet": {
                    "text": "String session = sessionId.get();"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DuplicatedCode",
          "kind": "fail",
          "level": "note",
          "message": {
            "text": "Duplicate code: lines 224-243"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/transport/StreamableHttpTransport.java"
                },
                "region": {
                  "startLine": 224,
                  "startColumn": 20,
                  "endLine": 225,
                  "endColumn": 7,
                  "charOffset": 9124,
                  "charLength": 33,
                  "snippet": {
                    "text": "String session = sessionId.get();"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "EmptyMethod",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "All implementations of this method are empty"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/logging/LoggingListener.java"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 10,
                  "endLine": 5,
                  "endColumn": 19,
                  "charOffset": 109,
                  "charLength": 9,
                  "snippet": {
                    "text": "onMessage"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "EmptyMethod",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "All implementations of this method are empty"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/util/ProgressListener.java"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 10,
                  "endLine": 5,
                  "endColumn": 20,
                  "charOffset": 100,
                  "charLength": 10,
                  "snippet": {
                    "text": "onProgress"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "UastIncorrectHttpHeaderInspection",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unknown HTTP header"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/transport/StreamableHttpTransport.java"
                },
                "region": {
                  "startLine": 155,
                  "startColumn": 32,
                  "endLine": 155,
                  "endColumn": 48,
                  "charOffset": 6176,
                  "charLength": 16,
                  "snippet": {
                    "text": "\"Mcp-Session-Id\""
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "BooleanMethodIsAlwaysInverted",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Calls to boolean method 'connected()' are always inverted"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/McpClient.java"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 13,
                  "endLine": 17,
                  "endColumn": 22,
                  "charOffset": 367,
                  "charLength": 9,
                  "snippet": {
                    "text": "connected"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "BooleanMethodIsAlwaysInverted",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Calls to boolean method 'isValid()' are always inverted"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/security/OriginValidator.java"
                },
                "region": {
                  "startLine": 16,
                  "startColumn": 20,
                  "endLine": 16,
                  "endColumn": 27,
                  "charOffset": 438,
                  "charLength": 7,
                  "snippet": {
                    "text": "isValid"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "UnnecessaryLocalVariable",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Local variable 'negotiatedVersion' is redundant"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/lifecycle/ProtocolLifecycle.java"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 16,
                  "endLine": 24,
                  "endColumn": 33,
                  "charOffset": 873,
                  "charLength": 17,
                  "snippet": {
                    "text": "negotiatedVersion"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameReturnValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "All implementations of method 'jsonrpc()' always return 'com.amannmalik.mcp.jsonrpc.JsonRpc.VERSION'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/jsonrpc/JsonRpcMessage.java"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 12,
                  "endLine": 5,
                  "endColumn": 19,
                  "charOffset": 165,
                  "charLength": 7,
                  "snippet": {
                    "text": "jsonrpc"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameReturnValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "All implementations of method 'allow()' always return 'true'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/security/SecurityPolicy.java"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 13,
                  "endLine": 7,
                  "endColumn": 18,
                  "charOffset": 130,
                  "charLength": 5,
                  "snippet": {
                    "text": "allow"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameParameterValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Value of parameter 'expected' is always 'LifecycleState.INIT'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/lifecycle/ProtocolLifecycle.java"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 45,
                  "endLine": 55,
                  "endColumn": 53,
                  "charOffset": 1690,
                  "charLength": 8,
                  "snippet": {
                    "text": "expected"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameParameterValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Value of parameter 'principalId' is always '\"default\"'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/McpServer.java"
                },
                "region": {
                  "startLine": 727,
                  "startColumn": 81,
                  "endLine": 727,
                  "endColumn": 92,
                  "charOffset": 33092,
                  "charLength": 11,
                  "snippet": {
                    "text": "principalId"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameParameterValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Value of parameter 'a' is always 'ValueType.TRUE'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/validation/SchemaValidator.java"
                },
                "region": {
                  "startLine": 122,
                  "startColumn": 74,
                  "endLine": 122,
                  "endColumn": 75,
                  "charOffset": 6239,
                  "charLength": 1,
                  "snippet": {
                    "text": "a"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameParameterValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Value of parameter 'cap' is always 'ServerCapability.LOGGING'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/McpServer.java"
                },
                "region": {
                  "startLine": 348,
                  "startColumn": 59,
                  "endLine": 348,
                  "endColumn": 62,
                  "charOffset": 15571,
                  "charLength": 3,
                  "snippet": {
                    "text": "cap"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "SameParameterValue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Value of parameter 'b' is always 'ValueType.FALSE'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/validation/SchemaValidator.java"
                },
                "region": {
                  "startLine": 122,
                  "startColumn": 97,
                  "endLine": 122,
                  "endColumn": 98,
                  "charOffset": 6262,
                  "charLength": 1,
                  "snippet": {
                    "text": "b"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "RedundantThrows",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "The declared exception 'IOException' is never thrown in any method implementation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/McpServer.java"
                },
                "region": {
                  "startLine": 776,
                  "startColumn": 62,
                  "endLine": 776,
                  "endColumn": 73,
                  "charOffset": 34564,
                  "charLength": 11,
                  "snippet": {
                    "text": "IOException"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "RedundantThrows",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "The declared exception 'ServletException' is never thrown"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/transport/StreamableHttpTransport.java"
                },
                "region": {
                  "startLine": 129,
                  "startColumn": 88,
                  "endLine": 129,
                  "endColumn": 104,
                  "charOffset": 4841,
                  "charLength": 16,
                  "snippet": {
                    "text": "ServletException"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'n' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/prompts/PromptCodec.java"
                },
                "region": {
                  "startLine": 62,
                  "startColumn": 74,
                  "endLine": 62,
                  "endColumn": 75,
                  "charOffset": 2558,
                  "charLength": 1,
                  "snippet": {
                    "text": "n"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'obj' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/roots/RootsCodec.java"
                },
                "region": {
                  "startLine": 36,
                  "startColumn": 90,
                  "endLine": 36,
                  "endColumn": 93,
                  "charOffset": 1013,
                  "charLength": 3,
                  "snippet": {
                    "text": "obj"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'request' is not used in any implementation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/sampling/SamplingProvider.java"
                },
                "region": {
                  "startLine": 5,
                  "startColumn": 62,
                  "endLine": 5,
                  "endColumn": 69,
                  "charOffset": 165,
                  "charLength": 7,
                  "snippet": {
                    "text": "request"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'req' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/roots/RootsCodec.java"
                },
                "region": {
                  "startLine": 16,
                  "startColumn": 60,
                  "endLine": 16,
                  "endColumn": 63,
                  "charOffset": 356,
                  "charLength": 3,
                  "snippet": {
                    "text": "req"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'n' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/tools/ToolCodec.java"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 71,
                  "endLine": 44,
                  "endColumn": 72,
                  "charOffset": 1825,
                  "charLength": 1,
                  "snippet": {
                    "text": "n"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'req' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/ping/PingCodec.java"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 60,
                  "endLine": 17,
                  "endColumn": 63,
                  "charOffset": 450,
                  "charLength": 3,
                  "snippet": {
                    "text": "req"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'n' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/roots/RootsCodec.java"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 72,
                  "endLine": 32,
                  "endColumn": 73,
                  "charOffset": 861,
                  "charLength": 1,
                  "snippet": {
                    "text": "n"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'obj' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/roots/RootsCodec.java"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 66,
                  "endLine": 20,
                  "endColumn": 69,
                  "charOffset": 486,
                  "charLength": 3,
                  "snippet": {
                    "text": "obj"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'obj' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/prompts/PromptCodec.java"
                },
                "region": {
                  "startLine": 66,
                  "startColumn": 94,
                  "endLine": 66,
                  "endColumn": 97,
                  "charOffset": 2714,
                  "charLength": 3,
                  "snippet": {
                    "text": "obj"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'resp' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/ping/PingCodec.java"
                },
                "region": {
                  "startLine": 25,
                  "startColumn": 63,
                  "endLine": 25,
                  "endColumn": 67,
                  "charOffset": 704,
                  "charLength": 4,
                  "snippet": {
                    "text": "resp"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'obj' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/ResourcesCodec.java"
                },
                "region": {
                  "startLine": 133,
                  "startColumn": 96,
                  "endLine": 133,
                  "endColumn": 99,
                  "charOffset": 6096,
                  "charLength": 3,
                  "snippet": {
                    "text": "obj"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Variable 'name' is never used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/completion/InMemoryCompletionProvider.java"
                },
                "region": {
                  "startLine": 38,
                  "startColumn": 63,
                  "endLine": 38,
                  "endColumn": 67,
                  "charOffset": 1681,
                  "charLength": 4,
                  "snippet": {
                    "text": "name"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'request' is not used in any implementation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/elicitation/ElicitationProvider.java"
                },
                "region": {
                  "startLine": 6,
                  "startColumn": 51,
                  "endLine": 6,
                  "endColumn": 58,
                  "charOffset": 139,
                  "charLength": 7,
                  "snippet": {
                    "text": "request"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'n' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/ResourcesCodec.java"
                },
                "region": {
                  "startLine": 129,
                  "startColumn": 75,
                  "endLine": 129,
                  "endColumn": 76,
                  "charOffset": 5938,
                  "charLength": 1,
                  "snippet": {
                    "text": "n"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Parameter 'obj' is not used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/tools/ToolCodec.java"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 88,
                  "endLine": 48,
                  "endColumn": 91,
                  "charOffset": 1975,
                  "charLength": 3,
                  "snippet": {
                    "text": "obj"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "unused",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Variable 'uri' is never used"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/completion/InMemoryCompletionProvider.java"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 65,
                  "endLine": 41,
                  "endColumn": 68,
                  "charOffset": 1861,
                  "charLength": 3,
                  "snippet": {
                    "text": "uri"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "EqualsWithItself",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'equals()' called on itself"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/completion/InMemoryCompletionProvider.java"
                },
                "region": {
                  "startLine": 42,
                  "startColumn": 24,
                  "endLine": 42,
                  "endColumn": 30,
                  "charOffset": 1952,
                  "charLength": 6,
                  "snippet": {
                    "text": "equals"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "EqualsWithItself",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'equals()' called on itself"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/completion/InMemoryCompletionProvider.java"
                },
                "region": {
                  "startLine": 39,
                  "startColumn": 25,
                  "endLine": 39,
                  "endColumn": 31,
                  "charOffset": 1773,
                  "charLength": 6,
                  "snippet": {
                    "text": "equals"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "MismatchedQueryAndUpdateOfCollection",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Contents of empty collection 'clientSpecs' are queried, but it's never populated"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/cli/HostCommand.java"
                },
                "region": {
                  "startLine": 33,
                  "startColumn": 26,
                  "endLine": 33,
                  "endColumn": 37,
                  "charOffset": 1245,
                  "charLength": 11,
                  "snippet": {
                    "text": "clientSpecs"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Method invocation 'uri' may produce 'NullPointerException'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 52,
                  "endLine": 59,
                  "endColumn": 55,
                  "charOffset": 2436,
                  "charLength": 3,
                  "snippet": {
                    "text": "uri"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/tools/InMemoryToolProvider.java"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 15,
                  "endLine": 59,
                  "endColumn": 23,
                  "charOffset": 2250,
                  "charLength": 8,
                  "snippet": {
                    "text": "removeIf"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 58,
                  "startColumn": 41,
                  "endLine": 58,
                  "endColumn": 44,
                  "charOffset": 2370,
                  "charLength": 3,
                  "snippet": {
                    "text": "add"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 64,
                  "startColumn": 19,
                  "endLine": 64,
                  "endColumn": 27,
                  "charOffset": 2554,
                  "charLength": 8,
                  "snippet": {
                    "text": "removeIf"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/tools/InMemoryToolProvider.java"
                },
                "region": {
                  "startLine": 53,
                  "startColumn": 15,
                  "endLine": 53,
                  "endColumn": 18,
                  "charOffset": 2084,
                  "charLength": 3,
                  "snippet": {
                    "text": "add"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/tools/InMemoryToolProvider.java"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 39,
                  "endLine": 54,
                  "endColumn": 42,
                  "charOffset": 2133,
                  "charLength": 3,
                  "snippet": {
                    "text": "put"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 70,
                  "startColumn": 19,
                  "endLine": 70,
                  "endColumn": 22,
                  "charOffset": 2733,
                  "charLength": 3,
                  "snippet": {
                    "text": "add"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 75,
                  "startColumn": 19,
                  "endLine": 75,
                  "endColumn": 27,
                  "charOffset": 2850,
                  "charLength": 8,
                  "snippet": {
                    "text": "removeIf"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DataFlowIssue",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Immutable object is modified"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/server/resources/InMemoryResourceProvider.java"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 39,
                  "endLine": 59,
                  "endColumn": 42,
                  "charOffset": 2423,
                  "charLength": 3,
                  "snippet": {
                    "text": "put"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "ResultOfMethodCallIgnored",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Result of 'BlockingQueue.offer()' is ignored"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/elicitation/BlockingElicitationProvider.java"
                },
                "region": {
                  "startLine": 14,
                  "startColumn": 19,
                  "endLine": 14,
                  "endColumn": 24,
                  "charOffset": 520,
                  "charLength": 5,
                  "snippet": {
                    "text": "offer"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "ResultOfMethodCallIgnored",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Result of 'BlockingQueue.offer()' is ignored"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/client/sampling/BlockingSamplingProvider.java"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 19,
                  "endLine": 11,
                  "endColumn": 24,
                  "charOffset": 475,
                  "charLength": 5,
                  "snippet": {
                    "text": "offer"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "ResultOfMethodCallIgnored",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Result of 'URI.create()' is ignored"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/validation/SchemaValidator.java"
                },
                "region": {
                  "startLine": 98,
                  "startColumn": 44,
                  "endLine": 98,
                  "endColumn": 50,
                  "charOffset": 5270,
                  "charLength": 6,
                  "snippet": {
                    "text": "create"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "ResultOfMethodCallIgnored",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Result of 'BlockingQueue.offer()' is ignored"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/transport/StreamableHttpTransport.java"
                },
                "region": {
                  "startLine": 117,
                  "startColumn": 23,
                  "endLine": 117,
                  "endColumn": 28,
                  "charOffset": 4479,
                  "charLength": 5,
                  "snippet": {
                    "text": "offer"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "resource",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'McpClient' used without 'try'-with-resources statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/security/HostProcess.java"
                },
                "region": {
                  "startLine": 56,
                  "startColumn": 36,
                  "endLine": 56,
                  "endColumn": 42,
                  "charOffset": 1985,
                  "charLength": 6,
                  "snippet": {
                    "text": "remove"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "resource",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'McpClient' used without 'try'-with-resources statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/security/HostProcess.java"
                },
                "region": {
                  "startLine": 50,
                  "startColumn": 21,
                  "endLine": 50,
                  "endColumn": 27,
                  "charOffset": 1841,
                  "charLength": 6,
                  "snippet": {
                    "text": "remove"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "resource",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'StreamableHttpTransport' used without 'try'-with-resources statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/cli/ServerCommand.java"
                },
                "region": {
                  "startLine": 56,
                  "startColumn": 50,
                  "endLine": 56,
                  "endColumn": 73,
                  "charOffset": 1998,
                  "charLength": 23,
                  "snippet": {
                    "text": "StreamableHttpTransport"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "resource",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'ExecutorService' used without 'try'-with-resources statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/ping/PingMonitor.java"
                },
                "region": {
                  "startLine": 18,
                  "startColumn": 42,
                  "endLine": 18,
                  "endColumn": 65,
                  "charOffset": 483,
                  "charLength": 23,
                  "snippet": {
                    "text": "newSingleThreadExecutor"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "DuplicateBranchesInSwitch",
          "kind": "fail",
          "level": "note",
          "message": {
            "text": "Duplicate branch in 'switch'"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/main/java/com/amannmalik/mcp/lifecycle/LifecycleCodec.java"
                },
                "region": {
                  "startLine": 67,
                  "startColumn": 31,
                  "endLine": 67,
                  "endColumn": 58,
                  "charOffset": 2666,
                  "charLength": 27,
                  "snippet": {
                    "text": "b.add(\"listChanged\", true);"
                  }
                }
              }
            }
          ]
        }
      ],
      "newlineSequences": [
        "\r\n",
        "\n"
      ]
    }
  ]
}